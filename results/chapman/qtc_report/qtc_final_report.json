{
  "project": "Kepler-ECG",
  "phase": "QTc Formula Discovery",
  "dataset": "chapman",
  "timestamp": "2026-01-04T20:22:47.411945",
  "status": "COMPLETED",
  "executive_summary": {
    "objective": "Discover interpretable QTc correction formula superior to Bazett/Fridericia",
    "outcome": "SUCCESS - Kepler formula achieves 0.6x better HR-independence than Bazett",
    "key_finding": "QTc = QT - 495.11 * cbrt(RR) + 466.81"
  },
  "wave_delineation": {
    "total_ecgs": 45133,
    "success_rate": 99.75,
    "method": "NeuroKit2 DWT delineation"
  },
  "discovered_formulas": {
    "kepler_cubic": {
      "formula": "QTc = QT - 495.11 * cbrt(RR) + 466.81",
      "complexity": 9,
      "hr_correlation": 0.075
    },
    "kepler_linear": {
      "formula": "QTc = QT - 184.54 * RR + 156.72",
      "complexity": 7,
      "hr_correlation": 0.1236
    },
    "kepler_factor": {
      "formula": "QTc = QT * (0.364/RR + 0.562)",
      "complexity": 5,
      "hr_correlation": 0.0365
    }
  },
  "comparison_with_literature": {
    "bazett_1920": {
      "formula": "QTc = QT / sqrt(RR)",
      "hr_correlation": 0.0486
    },
    "fridericia_1920": {
      "formula": "QTc = QT / cbrt(RR)",
      "hr_correlation": 0.3106
    }
  },
  "validation_results": {
    "timestamp": "2026-01-04T19:55:12.225394",
    "input_file": "results\\chapman\\qtc\\qtc_sr_dataset_all.csv",
    "n_samples": 41325,
    "hr_independence": {
      "QTc_Bazett": {
        "pearson_r": 0.0486,
        "pearson_p": 5.320273304097571e-23,
        "spearman_rho": 0.0921,
        "abs_r": 0.0486
      },
      "QTc_Fridericia": {
        "pearson_r": -0.3106,
        "pearson_p": 0.0,
        "spearman_rho": -0.3266,
        "abs_r": 0.3106
      },
      "QTc_Framingham": {
        "pearson_r": -0.2661,
        "pearson_p": 0.0,
        "spearman_rho": -0.2828,
        "abs_r": 0.2661
      },
      "QTc_Hodges": {
        "pearson_r": -0.1164,
        "pearson_p": 1.3070046945101488e-124,
        "spearman_rho": -0.1887,
        "abs_r": 0.1164
      },
      "QTc_Kepler_Linear": {
        "pearson_r": -0.1236,
        "pearson_p": 1.8225548697234548e-140,
        "spearman_rho": -0.1114,
        "abs_r": 0.1236
      },
      "QTc_Kepler_Cubic": {
        "pearson_r": -0.075,
        "pearson_p": 1.3520259340851196e-52,
        "spearman_rho": -0.0818,
        "abs_r": 0.075
      },
      "QTc_Kepler_Factor": {
        "pearson_r": -0.0365,
        "pearson_p": 1.140738369177239e-13,
        "spearman_rho": -0.0298,
        "abs_r": 0.0365
      }
    },
    "hr_bin_analysis": {
      "QTc_Bazett": {
        "40-60": {
          "n": 16677,
          "mean": 389.9,
          "std": 43.02,
          "median": 390.27
        },
        "60-80": {
          "n": 9412,
          "mean": 383.11,
          "std": 59.82,
          "median": 392.53
        },
        "80-100": {
          "n": 6012,
          "mean": 394.58,
          "std": 56.06,
          "median": 404.2
        },
        "100-120": {
          "n": 6591,
          "mean": 400.9,
          "std": 49.05,
          "median": 410.11
        },
        "120-150": {
          "n": 2557,
          "mean": 382.37,
          "std": 45.02,
          "median": 381.41
        },
        "cross_bin_variation": {
          "mean_of_means": 390.17,
          "std_of_means": 7.0,
          "range_of_means": 18.53
        }
      },
      "QTc_Fridericia": {
        "40-60": {
          "n": 16677,
          "mean": 395.7,
          "std": 43.36,
          "median": 395.96
        },
        "60-80": {
          "n": 9412,
          "mean": 373.73,
          "std": 58.38,
          "median": 382.66
        },
        "80-100": {
          "n": 6012,
          "mean": 369.95,
          "std": 52.61,
          "median": 379.0
        },
        "100-120": {
          "n": 6591,
          "mean": 363.69,
          "std": 44.74,
          "median": 371.82
        },
        "120-150": {
          "n": 2557,
          "mean": 335.49,
          "std": 40.12,
          "median": 334.65
        },
        "cross_bin_variation": {
          "mean_of_means": 367.71,
          "std_of_means": 19.39,
          "range_of_means": 60.21
        }
      },
      "QTc_Framingham": {
        "40-60": {
          "n": 16677,
          "mean": 392.95,
          "std": 44.94,
          "median": 393.38
        },
        "60-80": {
          "n": 9412,
          "mean": 376.63,
          "std": 55.93,
          "median": 385.11
        },
        "80-100": {
          "n": 6012,
          "mean": 374.5,
          "std": 46.3,
          "median": 382.48
        },
        "100-120": {
          "n": 6591,
          "mean": 367.47,
          "std": 36.95,
          "median": 374.22
        },
        "120-150": {
          "n": 2557,
          "mean": 342.04,
          "std": 31.19,
          "median": 341.16
        },
        "cross_bin_variation": {
          "mean_of_means": 370.72,
          "std_of_means": 16.59,
          "range_of_means": 50.91
        }
      },
      "QTc_Hodges": {
        "40-60": {
          "n": 16677,
          "mean": 398.99,
          "std": 44.81,
          "median": 399.07
        },
        "60-80": {
          "n": 9412,
          "mean": 373.1,
          "std": 55.95,
          "median": 381.59
        },
        "80-100": {
          "n": 6012,
          "mean": 375.22,
          "std": 46.24,
          "median": 383.24
        },
        "100-120": {
          "n": 6591,
          "mean": 383.05,
          "std": 36.66,
          "median": 389.86
        },
        "120-150": {
          "n": 2557,
          "mean": 384.22,
          "std": 30.41,
          "median": 384.85
        },
        "cross_bin_variation": {
          "mean_of_means": 382.92,
          "std_of_means": 9.12,
          "range_of_means": 25.89
        }
      },
      "QTc_Kepler_Linear": {
        "40-60": {
          "n": 16677,
          "mean": 362.19,
          "std": 45.21,
          "median": 362.77
        },
        "60-80": {
          "n": 9412,
          "mean": 352.93,
          "std": 55.98,
          "median": 361.59
        },
        "80-100": {
          "n": 6012,
          "mean": 356.44,
          "std": 46.25,
          "median": 364.51
        },
        "100-120": {
          "n": 6591,
          "mean": 353.15,
          "std": 36.85,
          "median": 359.78
        },
        "120-150": {
          "n": 2557,
          "mean": 330.82,
          "std": 31.01,
          "median": 330.05
        },
        "cross_bin_variation": {
          "mean_of_means": 351.11,
          "std_of_means": 10.68,
          "range_of_means": 31.37
        }
      },
      "QTc_Kepler_Cubic": {
        "40-60": {
          "n": 16677,
          "mean": 364.35,
          "std": 44.91,
          "median": 364.8
        },
        "60-80": {
          "n": 9412,
          "mean": 351.27,
          "std": 55.97,
          "median": 359.96
        },
        "80-100": {
          "n": 6012,
          "mean": 356.81,
          "std": 46.24,
          "median": 364.83
        },
        "100-120": {
          "n": 6591,
          "mean": 358.72,
          "std": 36.72,
          "median": 365.34
        },
        "120-150": {
          "n": 2557,
          "mean": 344.09,
          "std": 30.56,
          "median": 343.32
        },
        "cross_bin_variation": {
          "mean_of_means": 355.05,
          "std_of_means": 6.89,
          "range_of_means": 20.26
        }
      },
      "QTc_Kepler_Factor": {
        "40-60": {
          "n": 16677,
          "mean": 364.96,
          "std": 40.01,
          "median": 365.22
        },
        "60-80": {
          "n": 9412,
          "mean": 350.32,
          "std": 54.66,
          "median": 358.78
        },
        "80-100": {
          "n": 6012,
          "mean": 357.11,
          "std": 50.73,
          "median": 365.9
        },
        "100-120": {
          "n": 6591,
          "mean": 363.65,
          "std": 44.47,
          "median": 372.06
        },
        "120-150": {
          "n": 2557,
          "mean": 351.24,
          "std": 41.13,
          "median": 350.15
        },
        "cross_bin_variation": {
          "mean_of_means": 357.46,
          "std_of_means": 6.07,
          "range_of_means": 14.64
        }
      }
    },
    "cv_stability": {
      "QTc_Bazett": {
        "mean_r": 0.0485,
        "std_r": 0.0071,
        "min_r": 0.0383,
        "max_r": 0.0578
      },
      "QTc_Fridericia": {
        "mean_r": -0.3107,
        "std_r": 0.007,
        "min_r": -0.321,
        "max_r": -0.2997
      },
      "QTc_Framingham": {
        "mean_r": -0.2662,
        "std_r": 0.0074,
        "min_r": -0.277,
        "max_r": -0.2548
      },
      "QTc_Hodges": {
        "mean_r": -0.1164,
        "std_r": 0.0066,
        "min_r": -0.1246,
        "max_r": -0.1066
      },
      "QTc_Kepler_Linear": {
        "mean_r": -0.1237,
        "std_r": 0.007,
        "min_r": -0.1343,
        "max_r": -0.1129
      },
      "QTc_Kepler_Cubic": {
        "mean_r": -0.075,
        "std_r": 0.0067,
        "min_r": -0.0847,
        "max_r": -0.0648
      },
      "QTc_Kepler_Factor": {
        "mean_r": -0.0365,
        "std_r": 0.0071,
        "min_r": -0.0464,
        "max_r": -0.0266
      }
    },
    "clinical_thresholds": {
      "QTc_Bazett": {
        "n_total": 41325,
        "mean_qtc": 390.24,
        "std_qtc": 50.75,
        "prolonged_450ms": {
          "n": 3602,
          "pct": 8.72
        },
        "prolonged_460ms": {
          "n": 2357,
          "pct": 5.7
        },
        "high_risk_500ms": {
          "n": 452,
          "pct": 1.09
        },
        "short_340ms": {
          "n": 5393,
          "pct": 13.05
        }
      },
      "QTc_Fridericia": {
        "n_total": 41325,
        "mean_qtc": 378.04,
        "std_qtc": 51.48,
        "prolonged_450ms": {
          "n": 2136,
          "pct": 5.17
        },
        "prolonged_460ms": {
          "n": 1465,
          "pct": 3.55
        },
        "high_risk_500ms": {
          "n": 321,
          "pct": 0.78
        },
        "short_340ms": {
          "n": 7453,
          "pct": 18.04
        }
      },
      "QTc_Framingham": {
        "n_total": 41325,
        "mean_qtc": 379.22,
        "std_qtc": 48.17,
        "prolonged_450ms": {
          "n": 1972,
          "pct": 4.77
        },
        "prolonged_460ms": {
          "n": 1343,
          "pct": 3.25
        },
        "high_risk_500ms": {
          "n": 309,
          "pct": 0.75
        },
        "short_340ms": {
          "n": 6922,
          "pct": 16.75
        }
      },
      "QTc_Hodges": {
        "n_total": 41325,
        "mean_qtc": 386.16,
        "std_qtc": 47.33,
        "prolonged_450ms": {
          "n": 2340,
          "pct": 5.66
        },
        "prolonged_460ms": {
          "n": 1589,
          "pct": 3.85
        },
        "high_risk_500ms": {
          "n": 360,
          "pct": 0.87
        },
        "short_340ms": {
          "n": 5224,
          "pct": 12.64
        }
      },
      "QTc_Kepler_Linear": {
        "n_total": 41325,
        "mean_qtc": 355.74,
        "std_qtc": 46.93,
        "prolonged_450ms": {
          "n": 685,
          "pct": 1.66
        },
        "prolonged_460ms": {
          "n": 469,
          "pct": 1.13
        },
        "high_risk_500ms": {
          "n": 133,
          "pct": 0.32
        },
        "short_340ms": {
          "n": 12069,
          "pct": 29.21
        }
      },
      "QTc_Kepler_Cubic": {
        "n_total": 41325,
        "mean_qtc": 358.04,
        "std_qtc": 46.51,
        "prolonged_450ms": {
          "n": 698,
          "pct": 1.69
        },
        "prolonged_460ms": {
          "n": 489,
          "pct": 1.18
        },
        "high_risk_500ms": {
          "n": 131,
          "pct": 0.32
        },
        "short_340ms": {
          "n": 11217,
          "pct": 27.14
        }
      },
      "QTc_Kepler_Factor": {
        "n_total": 41325,
        "mean_qtc": 359.38,
        "std_qtc": 46.55,
        "prolonged_450ms": {
          "n": 685,
          "pct": 1.66
        },
        "prolonged_460ms": {
          "n": 455,
          "pct": 1.1
        },
        "high_risk_500ms": {
          "n": 102,
          "pct": 0.25
        },
        "short_340ms": {
          "n": 10669,
          "pct": 25.82
        }
      }
    },
    "ranking": [
      {
        "rank": 1,
        "formula": "QTc_Kepler_Factor",
        "abs_r": 0.0365
      },
      {
        "rank": 2,
        "formula": "QTc_Bazett",
        "abs_r": 0.0486
      },
      {
        "rank": 3,
        "formula": "QTc_Kepler_Cubic",
        "abs_r": 0.075
      },
      {
        "rank": 4,
        "formula": "QTc_Hodges",
        "abs_r": 0.1164
      },
      {
        "rank": 5,
        "formula": "QTc_Kepler_Linear",
        "abs_r": 0.1236
      },
      {
        "rank": 6,
        "formula": "QTc_Framingham",
        "abs_r": 0.2661
      },
      {
        "rank": 7,
        "formula": "QTc_Fridericia",
        "abs_r": 0.3106
      }
    ]
  },
  "sr_results": {
    "timestamp": "2026-01-04T14:48:49.687083",
    "input_file": "results\\chapman\\qtc\\qtc_sr_dataset_all.csv",
    "config": {
      "niterations": 150,
      "populations": 30,
      "population_size": 40,
      "maxsize": 15,
      "parsimony": 0.004,
      "binary_operators": [
        "+",
        "-",
        "*",
        "/"
      ],
      "unary_operators": [
        "sqrt",
        "cbrt",
        "inv",
        "square"
      ],
      "test_size": 0.2,
      "random_state": 42
    },
    "feature_set": "minimal",
    "features": [
      "QT_interval_ms",
      "RR_interval_sec"
    ],
    "train_size": 33060,
    "test_size": 8265,
    "best_overall": {
      "abs_r_hr": Infinity,
      "approach": null
    },
    "approaches": {}
  }
}